'use client';
import { useEffect } from 'react';
import { useSearchParams, useRouter } from 'next/navigation';
import SGConnectManager from '@/lib/SGConnectManager';

export default function CallbackPage() {
  const params = useSearchParams();
  const router = useRouter();

  useEffect(() => {
    const code = params.get('code');
    if (code) {
      SGConnectManager.getToken(code)
        .then((data) => {
          const decoded = SGConnectManager.decodeJWT(data.id_token);

          // Stocker les infos dans localStorage ou autre (facultatif)
          localStorage.setItem('access_token', data.access_token);
          localStorage.setItem('user_info', JSON.stringify(decoded));

          // ✅ Redirection vers la HomePage
          router.push('/home');
        })
        .catch((err) => {
          console.error('Erreur lors de la récupération du token :', err);
          router.push('/error'); // Rediriger vers une page d’erreur si besoin
        });
    }
  }, [params]);

  return <div>Authentification en cours...</div>;
}
'use client';
import SGConnectManager from '@/lib/SGConnectManager';

export default function Home() {
  const handleSignIn = async () => {
    await SGConnectManager.authorize();
  };

  return (
    <div>
      <button onClick={handleSignIn}>Sign In</button>
    </div>
  );
}
